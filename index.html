<!DOCTYPE html>
<html lang="zh">

<head>
  <title>MP3</title>
  <meta charset="UTF-8" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
    integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link href="https://sl17.github.io/music/css/index.css" rel="stylesheet" />
  <script type="text/javascript" src="https://sl17.github.io/music/js/index.js"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-391393-19');
  </script>
  <style>
    .setting-item {
      float: left;
      padding: 3px;
      margin: 5px;
      vertical-align: middle;
    }

    .setting-item input {
      margin: 0;
      padding: 0;
      vertical-align: middle;
      font-size: 1em;
      width: 4em;
      height: 1.5em;
      display: inline;
      margin-top: -4px;
    }

    .setting-item label {
      vertical-align: middle;
      font-size: 0.8em;
      display: inline;
    }

    .clear_row {
      float: none;
      clear: both;
    }
  </style>

  <style>
    .datagrid table {
      border-collapse: collapse;
      text-align: left;
      min-width: 480px;
      max-width: 100%;
    }

    .datagrid {
      font: normal 12px/150% Arial, Helvetica, sans-serif;
      background: #fff;
      overflow: hidden;
    }

    .datagrid table td,
    .datagrid table th {
      padding: 3px 4px;
    }

    .datagrid table thead th {
      background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #8C8C8C), color-stop(1, #7D7D7D));
      background: -moz-linear-gradient(center top, #8C8C8C 5%, #7D7D7D 100%);
      filter: progid: DXImageTransform.Microsoft.gradient (startColorstr='#8C8C8C', endColorstr='#7D7D7D');
      background-color: #8C8C8C;
      color: #FFFFFF;
      font-size: 15px;
      font-weight: bold;
      border-left: 1px solid #A3A3A3;
    }

    .datagrid table thead th:first-child {
      border: none;
    }

    .datagrid table tbody td {
      color: #7D7D7D;
      border-left: 1px solid #DBDBDB;
      font-size: 12px;
      border-bottom: 1px solid #E1EEF4;
      font-weight: normal;
    }

    .datagrid table tbody td:first-child {
      border-left: none;
    }

    .datagrid table tbody tr:last-child td {
      border-bottom: none;
    }

    .datagrid a {
      color: blue;
      text-decoration: underline;
    }

    .div_center {
      display: block;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      -webkit-transform: translate(-50%, -50%);
      -moz-transform: translate(-50%, -50%);
      -ms-transform: translate(-50%, -50%);
      -o-transform: translate(-50%, -50%);
    }

    .div_center2 {
      width: 100%;
      text-align: center;
    }
  </style>
</head>

<body>
  <div id="main_cent" class="jumbotron intro">
    <div class="container" style="height: 100%;">
      <div class="yamm-content">
        <div class="converter-body">
          <style>
            .app-area {
              background: radial-gradient(circle, #ededed 0, rgba(200, 171, 171, .37298669467787116) 91%, #e6e6e6 100%);
              border-radius: 5px;
              margin: -15px;
              padding: 5px 0px;
              margin-bottom: 10px;
            }

            .app-area .row {
              margin: 5px;
            }
          </style>
          <div class="app-area">
            <div class="row">
              <div class="span12">
                <div class="btn-toolbar">
                  <div class="btn-group">
                    <a class="btn btn-default " onclick="$('#open_url').modal('show');"><i class="fa fa-download"></i>
                      Open from URL...</a>
                  </div>
                  <div class="btn-group">
                    <a class="btn btn-default " onclick="$('#record_audio').modal('show');"><i
                        class="fa fa-microphone"></i> Record...</a>
                  </div>
                  <div class="btn-group">
                    <a id="showLibraryDLg" class="btn btn-default "><i class="fa fa-volume-up"></i> Sound Library...</a>
                  </div>
                  <!---->
                  <div class="btn-group">
                    <a class="btn btn-default "
                      onclick="$('#help_dlg').modal('show');$('#helpmenu a:first').click();"><i
                        class="fa fa-question"></i> Help...</a>
                  </div>
                  <div class="btn-group">
                    <div class="newsign"></div>
                  </div>

                </div>
              </div>
            </div>
            <div class="row">
              <div class="span12">
                <div class="btn-toolbar">
                  <div class="btn-group"><a class="btn btn-default btn-sm" onclick="$('#files').click();"><i
                        class="fa fa-folder-open"></i> 打开</a>
                    <input type="file" id="files" name="file" style="display: none;"> <input type="file" id="filesadd"
                      name="filesadd" style="display: none;"> <a class="btn btn-default btn-sm"
                      onclick="$('#filesadd').click();"><i class="fa fa-plus"></i> 添加</a> <a
                      class="btn btn-default btn-sm disabled" id="btn_undo"
                      onclick="$('#audioLayerControl')[0].undo();"><i class="fa fa-rotate-left"></i> 撤销</a>
                    <a class="btn btn-default btn-sm disabled" id="btn_redo"
                      onclick="$('#audioLayerControl')[0].redo();"><i class="fa fa-rotate-right"></i> 重做</a>
                    <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].copy();"><i
                        class="fa fa-copy"></i>
                      复制</a> <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].paste();"><i
                        class="fa fa-paste"></i>
                      粘帖</a> <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].cut();"><i
                        class="fa fa-cut"></i> 剪切</a>
                    <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].crop();"><i
                        class="fa fa-crop"></i>
                      剪裁</a> <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].del();"><i
                        class="fa fa-remove"></i>
                      删除</a> <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].reset();"><i
                        class="fa fa-history"></i>
                      恢复</a></div>
                  <div class="btn-group"><a class="btn btn-default btn-sm"
                      onclick="$('#audioLayerControl')[0].selectAll();"><i class="fa fa-arrows-alt"></i> 全选</a>
                    <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].selectFromS();"
                      title="make selection from start to current"><i class="fa fa-long-arrow-left"></i> </a> <a
                      class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].selectToE();"
                      title="make selection from current to end"><i class="fa fa-long-arrow-right"></i> </a> <a
                      class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].zoomIntoSelection();"><i
                        class="fa fa-search-plus"></i> 放大选择区</a>
                    <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].zoomToFit();"><i
                        class="fa fa-arrows-h"></i> 显示全部</a></div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="span12">
                <div id="audioloader" style='width: 100%; text-align: center;'></div>
                <div class="well">
                  <audioLayerControl id="audioLayerControl" title="" />
                </div>
                <!--<div id="editor">
                <div id="editorbox">
                    <audioLayerControl id="audioLayerControl" title="CloudCompany.mp3" />
                </div>
            </div>-->
              </div>
            </div>
            <div class="row">
              <div class="span12">
                <div class="btn-toolbar">
                  <div class="btn-group">
                    <button class="btn btn-default btn-sm" onclick="decrease_db()" title="改变选择区音量"><i
                        class="fa fa-angle-down"></i></button>
                    <button id="gain-db" class="btn disabled btn-sm" onclick="gain_btn_clicked()" title="改变选择区音量">0
                      db</button>
                    <button class="btn btn-default btn-sm" onclick="increase_db()" title="改变选择区音量"><i
                        class="fa fa-angle-up"></i></button>
                  </div>
                  <div class="btn-group"><a class="btn btn-default btn-sm"
                      onclick="$('#audioLayerControl')[0].filterNormalize();"><i class="fa fa-angle-double-up"></i>
                      高音</a>
                    <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].filterSilence();"><i
                        class="fa fa-angle-double-down"></i> 静音</a>
                    <a class="btn btn-default btn-sm" onclick="$('#audioLayerControl')[0].filterFadeIn();"><i
                        class="fa fa-angle-left"></i> 淡入</a> <a class="btn btn-default btn-sm"
                      onclick="$('#audioLayerControl')[0].filterFadeOut();"><i class="fa fa-angle-right"></i> 淡出</a>
                  </div>
                  <div class="btn-group"><a id="btn_play" class="btn btn-default btn-sm btn-large" onclick="play_fun();"
                      title="start/pause play"><i class="fa fa-play"></i></a> <a id="btn_pause" style="display: none;"
                      class="btn btn-default btn-sm btn-large disabled" title="start/pause play"><i
                        class="fa fa-pause"></i></a> <a id="btn_stop" class="btn btn-default btn-sm btn-large"
                      onclick="stop_fun(); " title="stop play"><i class="fa fa-stop"></i></a> <a id="btn_loop"
                      class="btn btn-default btn-sm btn-large" data-toggle="button"
                      onclick="$('#audioLayerControl')[0].toggleLoop();" title="play loop"><i
                        class="fa fa-repeat"></i></a> <a id="btn_goto_head" class="btn btn-default btn-sm btn-large"
                      onclick="$('#audioLayerControl')[0].goto_head();" title="go to head"> <i
                        class="fa fa-step-backward"></i></a> <a id="btn_set_start"
                      class="btn btn-default btn-sm disabled" onclick="set_start_sel();"
                      title="sets the start of the selection">[</a> <a id="btn_set_end"
                      class="btn btn-default btn-sm disabled" onclick="set_end_sel()"
                      title="sets the end of the selection">]</a></div>
                  <div class="btn-group"><a class="btn btn-sm btn-default"
                      onclick="$('#savewait').html(''); $('#save_audio').modal('show');"><i class="fa fa-save"></i>
                      保存</a></div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="span4 offset4" style="display: none;">
                <div class="progress progress-striped active">
                  <div id="app-progress" class="bar" style="width: 0%;"></div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="span12">
                <div class="well">
                  <div id="spectrum"></div>
                </div>
              </div>
            </div>
          </div>
          <script type="text/javascript">
            var db_gain = 0;
            function decrease_db() {
              --db_gain;
              update_db_gain_btn();
            }

            function increase_db() {
              ++db_gain;
              update_db_gain_btn();
            }

            function update_db_gain_btn() {
              var gain_btn = $('#gain-db')[0];

              gain_btn.innerHTML = db_gain + ' db';

              if (db_gain === 0) {
                gain_btn.className = 'btn disabled btn-sm';
              }
              else {
                gain_btn.className = 'btn btn-default btn-sm';
              }
            }

            function gain_btn_clicked() {
              $('#audioLayerControl')[0].filterGain(db_gain);
              db_gain = 0;
              update_db_gain_btn();
            }
          </script>
        </div>
      </div>
      <div id="loadfileerror" class="edit-modal modal fade" tabindex='-1'>
        <div class="modal-dialog">
          <div class="modal-content" id="edit_dialog">
            <div class="modal-header">
              <button type="button" class="close closePop" data-dismiss="modal" aria-label="Close"><span
                  aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
              <p>读取音频文件失败，可能需要转换成MP3或WAV格式。需要转换，请点击： <a target="_blank" href="/zh/music-converter">音乐转换器</a></p>
            </div>
            <div class="modal-footer">
              <div style="TEXT-ALIGN: center;">
                <button type="button" class="btn btn-default" data-dismiss="modal">close</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script type="text/javascript">
        var str_drag = "拖放文件到这里";
        var str_leftc = "左声道";
        var str_rightc = "右声道";
        var str_position = "起始位置:";
        var str_selection = "选择区域:";

        var procepid = "";
        function refresh_statu() {
          if ($('#audioLayerControl')[0].my_status() == "play") {
            $("#btn_play").html("<i class='fa fa-pause'>");
          }
          else {
            $("#btn_play").html("<i class='fa fa-play'>");
          }

          if ($('#audioLayerControl')[0].my_status() == "play" ||
            $('#audioLayerControl')[0].my_status() == "pause") {
            $("#btn_set_start").removeClass("disabled");
            $("#btn_set_end").removeClass("disabled");
          }
          else {
            $("#btn_set_start").addClass("disabled");
            $("#btn_set_end").addClass("disabled");
          }

        }

        function play_fun() {
          if ($('#audioLayerControl')[0].playStatu == "play") {
            $('#audioLayerControl')[0].my_pause();
          }
          else {
            $('#audioLayerControl')[0].my_setupdateui(refresh_statu);
            $('#audioLayerControl')[0].my_play();
          }
          refresh_statu();
        }

        function stop_fun() {
          $('#audioLayerControl')[0].my_stop();
          refresh_statu();
        }

        function set_start_sel() {
          $('#audioLayerControl')[0].set_start_sel();
        }

        function set_end_sel() {
          $('#audioLayerControl')[0].set_end_sel();
        }

        $("#pluswrap").hide();
        $("#audioloader").html("<i class='fa fa-refresh fa-spin'></i>");
        $(window).load(function () {
          onDocumentLoaded();
          var supportLabel = $('#browser_support')[0];
          if (typeof (window.AudioContext || window.webkitAudioContext) === 'undefined') {
            supportLabel.className = "label label-important";
            supportLabel.innerHTML = 'no web audio API support. try the latest Google Chrome build.';
            $('#welcomeModal').modal('show');
          }

          $('#savelink').click(function () {
            $('#audioLayerControl')[0].save($('#savelink')[0]);
            if (typeof (pplike_manualshowlike) != "undefined")
              pplike_manualshowlike();
          });

          function get_wavdata() {
            var acontrol = $('#audioLayerControl')[0].audioLayerControl;
            var wave = new WaveTrack();
            var sequenceList = [];
            for (var i = 0; i < acontrol.listOfSequenceEditors.length; ++i) {
              sequenceList.push(acontrol.listOfSequenceEditors[i].audioSequenceReference);
            }
            wave.fromAudioSequences(sequenceList);
            return wave.encodeWaveFile();
          }

          $('#savelink_more').click(function () {
            if (!$('#audioLayerControl')[0].audioLayerControl.listOfSequenceEditors[0].audioSequenceReference)
              return;

            $("#savewait_more").html("<i class='fa fa-refresh fa-spin'></i>  <span id='progress_sp_more'>initializing...</span>");
            var acontrol = $('#audioLayerControl')[0].audioLayerControl;
            var wavdata = get_wavdata();
            var out_bitRate = $('#more_bitRate').val();
            audio_convert(
              wavdata,
              out_bitRate,
              $('#fchannels').val(),
              $('#more_format').val(),
              function process(pent) {
                $("#progress_sp_more").html(pent + "%");
              },
              function done(audiodata, outputfile) {
                if (audiodata) {
                  var blob = new Blob([audiodata]);
                  var url = window.URL.createObjectURL(blob);
                  var savebtn = "<i class='fa fa-check fa-2x'></i><br>Save successful! <a download='" + outputfile + "' href='" + url + "'>Click to Save</a>";
                  $("#savewait_more").html(savebtn);
                  if (typeof (pplike_manualshowlike) != "undefined")
                    pplike_manualshowlike();
                }
                else {
                  $("#savewait_more").html("Save Faild!");
                }
              }
            );
          });

          $('#start_record').click(function () {
            start_record(
              function (msg) {
                $("#record_output").html(msg);
              },
              function draw(data) {
              },
              $("#record_draw")
            );

          });

          $('#stop_record').click(function () {
            stop_record(
              function result(ob) {
                $("#record_output").html("");
                $("#record_output").append(ob);
              }
            );
          });

          $('#savelink_m4r').click(function () {
            if (!$('#audioLayerControl')[0].audioLayerControl.listOfSequenceEditors[0].audioSequenceReference)
              return;

            $("#savewait_m4r").html("<i class='fa fa-refresh fa-spin'></i>  <span id='progress_sp_m4r'>initializing...</span>");
            var acontrol = $('#audioLayerControl')[0].audioLayerControl;
            var wavdata = get_wavdata();
            var out_bitRate = $('#m4r_bitRate').val();
            audio_convert(
              wavdata,
              out_bitRate,
              2,
              "aac",
              function process(pent) {
                $("#progress_sp_m4r").html(pent + "%");
              },
              function done(audiodata, outputfile) {
                if (audiodata) {
                  var blob = new Blob([audiodata]);
                  var url = window.URL.createObjectURL(blob);
                  var savebtn = "<i class='fa fa-check fa-2x'></i><br>Save successful! <a download='" + "export_ofoct.com.m4r" + "' href='" + url + "'>Click to Save</a>";
                  $("#savewait_m4r").html(savebtn);
                  if (typeof (pplike_manualshowlike) != "undefined")
                    pplike_manualshowlike();
                }
                else {
                  $("#savewait_m4r").html("Save Faild!");
                }
              }
            );
          });

          $('#savelink_mp3').click(function () {
            if (!$('#audioLayerControl')[0].audioLayerControl.listOfSequenceEditors[0].audioSequenceReference)
              return;

            $("#savewait").html("<i class='fa fa-refresh fa-spin'></i> encode to mp3... <span id='progress_sp'></span>");
            setTimeout(function () {
              var acontrol = $('#audioLayerControl')[0].audioLayerControl;
              var in_samplerate = acontrol.listOfSequenceEditors[0].audioSequenceReference.sampleRate;
              var in_left = acontrol.listOfSequenceEditors[0].audioSequenceReference.data;
              var in_right = acontrol.listOfSequenceEditors.length <= 1 ? null : acontrol.listOfSequenceEditors[1].audioSequenceReference.data;
              var out_channels = parseInt($('#channels').val(), 10);
              var out_bitRate = parseInt($('#bitRate').val(), 10);
              var out_samplerate = parseInt($('#out_samplerate').val(), 10);

              mp3_encode(in_samplerate, in_left, in_right, out_samplerate, out_channels, out_bitRate,
                function process(pent) {
                  $("#progress_sp").html(pent + "%");
                },
                function done(mp3data) {
                  var blob = new Blob(mp3data, { type: 'audio/mp3' });
                  var url = window.URL.createObjectURL(blob);
                  var savebtn = "<i class='fa fa-check fa-2x'></i><br>Mp3 encode successful! <a download='export_ofoct.com.mp3' href='" + url + "'>Click to Save</a>";
                  $("#savewait").html(savebtn);
                  if (typeof (pplike_manualshowlike) != "undefined")
                    pplike_manualshowlike();
                }
              );
            }, 1000);
          });

          $('#import_record_btn').click(function () {
            if (!record_result_blob)
              return;
            var files = [];
            var file = new File([record_result_blob], "file");
            files.push(file);
            $('#audioLayerControl')[0].loadfile(files, true);
            $('#record_audio').modal('toggle');
          });


          $('#record_audio').on('hidden.bs.modal', function () {
            $('#stop_record').click();
          })
          $('#open_url_btn').click(function () {
            $("#openurlwait").html("<i class='fa fa-refresh fa-spin'></i><div id='openurlwait_txt'></div>");
            doprocess(procepid,
              function (msg) {
                $("#openurlwait_txt").html(msg);
              },
              function () {

              }
            );

            var url = "/import_audio_file.php?type=fileurl&url="
              + encodeURIComponent($('#fileurl').val())
              + "&pid="
              + procepid
              + "&start_pos="
              + $('#start_cut_f').val()
              + "&end_pos="
              + $('#end_cut_f').val();
            load_url_to_array
              (
                url,
                function done(arrayBuffer) {
                  $("#openurlwait").html("");
                  $('#audioLayerControl')[0].loadArrayBuffer(arrayBuffer, true);
                  $('#open_url').modal('toggle');
                },
                function error(errmsg) {
                  $("#openurlwait").html(errmsg);
                }
              );
          });

          $('#save_btn').click(function () {
            $("#savewait").html("<i class='fa fa-refresh fa-spin'></i>");
            $activetab = $('#save_tabs').find('.tab-pane.active').attr('id');
            if ($activetab == "save_to_wav") {
              $('#audioLayerControl')[0].save($('#savelink')[0]);
              if (typeof (pplike_manualshowlike) != "undefined")
                pplike_manualshowlike();
              $("#savewait").html("");
            }
            else if ($activetab == "save_to_mp3") {

            }
          });

          function handleFileSelect2(evt) {
            evt.stopPropagation();
            evt.preventDefault();
            var files = evt.target.files;
            $('#audioLayerControl')[0].loadfile(files, ($(evt.currentTarget).attr('id') == "filesadd"));
            this.value = null;
          }
          document.getElementById('files').addEventListener('change', handleFileSelect2, false);
          document.getElementById('filesadd').addEventListener('change', handleFileSelect2, false);

          $('#audioLayerControl')[0].setStartAndEndFun(function st() {
            $("#audioloader").html("<i class='fa fa-refresh fa-spin'></i>");
          }, function ed(ret) {
            if (ret == "ok") {
              $("#audioloader").html("");
            }
            if (ret == "error") {
              $("#audioloader").html("");
              $("#loadfileerror").modal("show");
            }
          }, function error(info) {
            $("#errordlginfo").html(info);
            $("#commerrorinfo").modal("show");
          }, function lockscreen(lock) {
            if (lock) {
              $("#pluswrap").show();
            }
            else {
              $("#pluswrap").hide();
            }
          }
          );

          $('#audioLayerControl')[0].setUpdateUndoUIFun(function setUpdateUnDoUI(hisLen, curPos) {
            if (hisLen <= 0 || curPos > hisLen - 1) {
              $("#btn_undo").addClass("disabled");
              $("#btn_redo").addClass("disabled");
              return;
            }
            if (curPos <= -1) {
              $("#btn_undo").addClass("disabled");
            }
            else {
              $("#btn_undo").removeClass("disabled");
            }
            if (curPos == hisLen - 1) {
              $("#btn_redo").addClass("disabled");
            }
            else {
              $("#btn_redo").removeClass("disabled");
            }
          });

          $("#audioloader").html("");

          $("#help_dlg").draggable({
            handle: ".modal-header"
          });

          $("#helpmenu").on('click', 'a', function () {
            var url = $(this).attr("data-url");
            $("#tutorialFrame").attr("src", url);
          });

          $("#video_intr_btn").click(function () {
            var url = "https://www.youtube.com/embed/9dzV3zBmRpI";
            $("#videoIntrFrame").attr("src", url);
            $('#video_intr').modal('show');
          });

          function postLogs(m_action, m_keywords, m_soundID) {
            var url = "/log.php?m_action=" + m_action
              + "&m_keywords=" + m_keywords
              + "&m_soundID=" + m_soundID;
            $.ajax({
              type: "GET",
              url: url,
              data: "",
              dataType: "html",
              success: function (ret) {
                console.log('logs submit was successful.');
                console.log(ret);
              },
              error: function (data) {
                console.log('logs submit An error occurred.');
                console.log(data);
              },
            });
          }
          /*----------------------library dlg-------------------------------------*/
          var startItem = 0;

          $("input[ name='soundKeywrods' ]").keyup(function (event) {
            if (event.keyCode === 13) {
              startItem = 0;
              ;
            }
          });

          $('#showLibraryDLg').click(function () {
            $('#library_dlg').modal('show');
            getHotKeyword();
          });

          $('#searchBtn').click(function () {
            startItem = 0;
            ;
          });

          $('#searchResult').on('click', '.pageNum', function () {
            startItem = parseInt($(this).attr('dataItem'));
          });

          $('#hotKeyword').on('click', '.hkey', function () {
            $("input[ name='soundKeywrods' ]").val($(this).text());
            startItem = 0;
          });
          var playstatus = $("#playstatus");
          var pstatus = "";
          function initPlaySound(div) {
            $("#" + div).jPlayer({
              swfPath: "/js/jplayer/",
              supplied: "mp3",
              cssSelectorAncestor: "",
              size: {
                width: "1px",
                height: "1px"
              },
              play: function (event) {
                playstatus.html("<img width='64px' height='32px' src='/img/soundplay2.gif' />");
                console.log("play sound start.");
                pstatus = "play";
              },
              ended: function (event) {
                playstatus.html("");
                pstatus = "stop";
                console.log("play sound end.");
              },
              error: function (event) {
                playstatus.html("<span style='color:red;'>load sound error</span>");
                console.log("play sound error.");
                pstatus = "error";
              }
            });
          }
          function playSound(url) {
            $("#jquery_jplayer").jPlayer("setMedia", {
              mp3: url
            });
            $("#jquery_jplayer").jPlayer("play");
          }
          function stopSound() {
            $("#jquery_jplayer").jPlayer("stop");
          }
          initPlaySound("jquery_jplayer");

          $('#searchResult').on('click', '.btnPlay', function () {
            if (pstatus == "play") {
              playstatus.html("");
              stopSound();
            }
            var dataid = $(this).attr('dataid');
            playstatus = $("div [statuid=" + dataid + "]");
            playstatus.html("<i class='fa fa-refresh fa-spin'></i>");

            var playURL = $(this).attr('data-playURL');
            playSound(playURL);
            postLogs("lib-play", "", dataid);
          });

          $('#searchResult').on('click', '.btnStop', function () {
            playstatus.html("");
            stopSound();
          });

          $('#searchResult').on('click', '#searchYoutube', function () {
            var keyword = $(this).attr('data-keyword');
            postLogs("lib-searchYoutube", keyword, 0);
          });

          $('#searchResult').on('click', '.btnDownload', function () {
            var dataid = $(this).attr('dataid');
            postLogs("lib-download", "", dataid);
          });

          $('#searchResult').on('click', '.btnImport', function () {
            console.log("load aduio from url start...");
            if (pstatus == "play") {
              stopSound();
              playstatus.html("");
            }
            var dataid = $(this).attr('dataid');
            playstatus = $("div [statuid=" + dataid + "]");
            playstatus.html("<i class='fa fa-refresh fa-spin'></i>");
            var importUrl = $(this).attr('importUrl');
            var url = importUrl;
            load_url_to_array
              (
                url,
                function done(arrayBuffer) {
                  playstatus.html("");
                  $('#audioLayerControl')[0].loadArrayBuffer(arrayBuffer, true);
                  $('#library_dlg').modal('toggle');
                  console.log("load aduio from url done");
                },
                function error(errmsg) {
                  console.log("load aduio from url error");
                  playstatus.html("<span style='color:red;'>load sound error.</span>");
                }
              );
            console.log("load aduio from url end");
            postLogs("lib-import", "", dataid);
          });
        });
      </script>
    </div>
  </div>

  <style>
    .cookie-alert {
      background-color: rgba(24, 24, 24, 0.8);
      color: #e2e2ea;
      font-size: 12px;
      min-height: 48px;
      padding: 18px;
      position: fixed;
      left: 0;
      right: 0;
      z-index: 1021
    }
     .cookie-alert a {
      color: #fff;
      font-weight: bold
    }

    .cookie-alert-fixed-bottom {
      bottom: 0
    }

    .cookie-alert-close {
      font-size: 30px;
      position: absolute;
      right: 9px;
      top: 9px
    }

    .cookie-alert-close-button {
      background-color: transparent;
      border: transparent;
      padding: 0
    }

    .cookie-alert-body {
      padding-right: 24px
    }

    .cookie-alert a {
      color: #fff;
      font-weight: bold;
    }

    .cookie-alert-hide {
      display: none !important;
    }

    pre {
      white-space: pre-wrap;
      white-space: -moz-pre-wrap;
      white-space: -pre-wrap;
      white-space: -o-pre-wrap;
      word-wrap: break-word;
    }

    pre a {
      color: blue !important;
      text-decoration: underline !important;
    }
  </style>

  <script type="text/javascript">
    function cookie_setCookie(name, value) {
      var Days = 365;
      var date = new Date();
      date.setTime(date.getTime() + Days * 24 * 60 * 60 * 1000);
      document.cookie = name + "=" + escape(value) + ";expires=" + date.toGMTString();
    }
    function cookie_getCookie(name) {
      var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
      if (arr = document.cookie.match(reg)) {
        return unescape(arr[2]);
      }
      else {
        return null;
      }
    }
    function CookiedAlert() {
      var $this = $(".cookie-policy-banner"),
        $closeButton = $this.find('.js-close'),
        cookieKey = "gdpr_xxx";
      hasBeenDismissed = cookie_getCookie(cookieKey) === '1';
      if (!hasBeenDismissed) {
        $this.removeClass('cookie-alert-hide');
        $closeButton.on('click', function () {
          $this.hide();
          cookie_setCookie(cookieKey, '1');
        });
      }
    }
    CookiedAlert();
  </script>
  <script type="text/javascript">
    function ensureCssFileInclusion(cssFileToCheck) {
      var styleSheets = document.styleSheets;
      for (var i = 0, max = styleSheets.length; i < max; i++) {
        if (styleSheets[i].href == cssFileToCheck) {
          return;
        }
      }
      var link = document.createElement("link");
      link.rel = "stylesheet";
      link.href = "/css/font-awesome.min.css";
      document.getElementsByTagName("head")[0].appendChild(link);
    }
    function loadaddthis() {
      
      $("#main_cent").css("background-image", "url(/img/bk.jpg)");
      ensureCssFileInclusion("https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css");
    }
    $(window).load(function () {
      setTimeout("loadaddthis()", 1500);
      /**/
      bearAccount = new BearAccount();
      bearAccount.init("/account", "accountPanel", "");
    });/**/
  </script>

</body>

</html>